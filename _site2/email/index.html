<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js theme-light"> <!--<![endif]-->
 <!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
  <title>Email — Hans Engebretsen </title>
  <meta name="author" content="Hans Engebretsen" />
  <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/favicon/manifest.json">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#f68c3f">
<link rel="shortcut icon" href="/favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/favicon/mstile-144x144.png">
<meta name="msapplication-config" content="/favicon/browserconfig.xml">
<meta name="theme-color" content="#f68c3f">
  
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-41316517-3', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->



  <meta property="og:type"               content="website" />
  <meta property="og:title"              content="Email — Hans Engebretsen " />
  
    <meta property="og:description"        content="Hey there - I'm Hans and I'm a web / UX / UI Designer / Art Director / Purveyor of the internets / graphic designer / web creative looking to make the internets better." />
  <meta name="description" content="Hey there - I'm Hans and I'm a web / UX / UI Designer / Art Director / Purveyor of the internets / graphic designer / web creative looking to make the internets better.">
  
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  
  <meta property="og:image"              content="/img/haaans-og.jpg" />
  
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96x96.png">

  <!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href='//fonts.googleapis.com/css?family=Lekton:400,700|Merriweather:400,700,300italic' rel='stylesheet' type='text/css'>
    <!-- <link rel="stylesheet" type="text/css" href="/style.css" /> -->
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  </head>

  <body class="Email ">
    <div class="overlay">
     <header class="global-header left-align  top-nav" >
            <div class="image-wrap" id="profile-image">
                
                    
                        <img src="/img/he-logo-dark.svg" class="he-logo" alt="Hans Engebretsen" />
                    
                

            </div>
            <nav class="global-navigation">
                <div class="internal-nav-wrap">
                    <ul id="navigation-menu" class="menu">
                        
                         
                         
                         <li class="first  ">
                           <a class="" href="/about">about</a>
                         </li>
                        
                         
                         
                         <li class="  ">
                           <a class="" href="/work">work</a>
                         </li>
                        
                         
                         
                         <li class="  last">
                           <a class="" href="/articles">articles</a>
                         </li>
                        
                        <li><a href="#" id="social-toggle">elsewhere</a></li>
                    </ul>
                    <ul class="social">
                        <li><a href="http://codepen.io/hans" data="/hans">CodePen</a></li>
                        <li><a href="https://twitter.com/haahns" data="@haahns">Twitter</a></li>
                        <li><a href="http://dribbble.com/haaans" data="/haaans">Dribbble</a></li>
                        <li><a href="http://www.linkedin.com/in/haaans" data="/haaans">LinkedIn</a></li>
                    </ul>
                </div>
            </nav>
            <a href="#" class="close-toggle">+</a>
        </header>
    </div>
    <div class="menu-toggle-container" id="nav-toggle">
      <a href="#" class="menu-toggle-wrap"> <span class="icon-list"></span></a>
    </div>


        <nav class="article-controls" id="article-navigation">
    <ul>
        <li class="all"><a href="../articles">all</a></li>
         <li class="next"><a href="/node/">next</a></li>
         <li class="prev"><a href="/sketch/">prev</a></li>
    </ul>
</nav>

<article class="post ">
  <h1 class="title">HTML email that updates itself</h1>
  <h2 class="subtitle">March  8, 2016 | Project</h2>
<figure class="cover-image" ></figure>
  <div class="entry">
    <p>You know what sucks? Developing emails. This is one email project done for Garmin that I tried having some fun on, and made a bit more interesting by adding dynamic images too.</p>

<h1 id="the-idea">The idea</h1>
<p>We wanted recipients of the email to feel like they were a part of something bigger, contributing their fitness tracking data live to help the world’s total, as it raced to beat its yesterday.</p>

<h4 id="whats-the-point">What’s the point</h4>
<p>Inspire movement &amp; drive traffic &amp; for Beat Yesterday campaign site.</p>

<h1 id="make-it-update-itself">Make it update itself?</h1>

<p>Despite the web changing constantly, emails are still stuck ten years in the past in terms of tech, which makes doing something different really hard.</p>

<h4 id="gifs-duh">Gifs, Duh</h4>
<p>I love <a href="https://dribbble.com/HansE">Gifs</a> they’re especially powerful when used subtly and with class. The website, and the campaign were based on dynamic live data, so it seemed the perfect opportunity to leverage gifs.
s</p>
<h4 id="actual-live-data">Actual live data</h4>
<p>Here’s the hard part: Get the email to update to the actual live cumulative total of data that was coming in from Garmin Connect. So that if I opened the email at 3:55pm, I got our current count of steps the world needs left to beat yesterday’s step count. A 60 second gif turned out to be a good balance between average open time, and performance/file size.</p>

<h4 id="the-breakdown">The breakdown</h4>
<ol>
  <li>Start with an image src linked to a generic 60 gif, so something will show.</li>
  <li>Hook in to home-brewed API to calc steps left to beat yesterday = total steps made today - yesterdays total steps .</li>
  <li>Calculate the next 60 seconds of data.</li>
  <li>Generate 60 second gif that counted over 60 seconds worth of data.</li>
  <li>Run a CRON job every 60 seconds that ran a bash script to post the new 60 second gif from a dynamic PHP server to a static server where it would be viewed in the email (probably not best practice, but got the job done).
<span class="emails"></span></li>
</ol>

<h4 id="dynamic-dynamic-images">Dynamic, dynamic images</h4>
<p>So, the email isn’t actually running a script, it’s simply linking to the same gif, that’s updated on the server every 60 seconds. Several of countdowns write-ups I read link to a script that runs some trickery to work in emails, or create a gif where the last frame is constantly updated.</p>

<p>The email we were sending needed to be a bit more compatible, and assets needed to be run off of a static server (had the potential to be accessed by over 500k users at a time). Using a GIF turned out to be a bit more compatible (some versions of Outlook only show the first frame of gifs, but most other major clients rendered fine), and running the script on a separate server didn’t require the load and performance hit of using a dynamic server everytime someone opened the email.</p>

<h4 id="gmail-too">Gmail, too</h4>
<p>Turns out, gmail <a href="https://litmus.com/blog/gmail-adds-image-caching-what-you-need-to-know">caches images</a> across emails. So, if I have a Gmail account and open the email first, Gmail makes a ‘Gmail-cache’ version of that image and serves it to the next person on Gmail who opens the same email.</p>

<p>To allow the gif to be reloaded from our static servers every 60 seconds, we were able to <a href="http://www.redant.com.au/how-we-do/cache-busting-gmail-new-image-caching/">cache bust</a> using unique queries on the end of the image src.</p>

<h1 id="resources--credits">Resources &amp; Credits</h1>
<p>It’s shockingly difficult to find many technical details on email countdowns and dynamic email images. The best I found, is <a href="https://litmus.com/community/learning/27-how-to-add-a-countdown-timer-to-your-email">this article</a> by <a href="http://codepen.io/Omgitsonlyalex/">Alex Ilhan</a>. The foundation of the script used is based on his script for a <a href="https://github.com/Omgitsonlyalex/EmailCountdown">countdown timer</a> on Github, so again credit to Alex.</p>

<p>You can check out my (somewhat) sanitized PHP up on <a href="https://github.com/HansEngebretsen/dynamic-email">github</a>.</p>

<h1 id="the-result">The Result</h1>

<p data-height="500" data-theme-id="21124" data-slug-hash="qbyYEr" data-default-tab="result" data-user="hans" data-embed-version="2" class="codepen">See the Pen <a href="https://codepen.io/hans/pen/qbyYEr/">Self-updating HTML email</a> by Hans Engebretsen (<a href="http://codepen.io/hans">@hans</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<script async="" src="//assets.codepen.io/assets/embed/ei.js"></script>

<h6 id="disclaimer">Disclaimer</h6>
<p><em>I am by no means a PHP expert, so I’m 100% positive, there’s a better way to do this, this is what got the job done for me.</em></p>

  </div>

<!--   <div class="date">
    Written on March  8, 2016
  </div>
 -->
  
</article>

    <footer>
      <div class="bio">
           <h2>Built by hand <span>|</span> Source on <a href="https://github.com/HansEngebretsen">GitHub</a></h2>
      </div>
      <a href="" class="scrollUp opaque" id="scrollUp">Scroll Up</a>
</footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<!-- <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script> -->


<!-- My Scripts -->
<script src="/js/production.min.js"></script>


  </body>
</html>